# [JSP] 쿠키

## 쿠키란?

HTTP프로토콜은 웹 브라우저(클라이언트)의 요청에 대한 응답을 하고 나면 해당 클라이언트와의 연결을 끊는다. HTTP프로토콜은 상태에 대한 지속적인 연결이 없다.

**쿠키**는 상태가 없는 프로토콜을 위해 상태를 지속시키기 위한 방법이다. 쿠키는 웹 브라우저의 정보를 웹브라우저에 저장하므로, 이후에 서버로 전송되는 요청에는 쿠키가 가지고 있는 정보가 같이 포함되어 전송된다. 



**쿠키**는 웹 사이트에 접속할 때 생성되는 정보를 담은 임시 파일이다. 

일반적으로 쿠키는 4KB이하로 용량이 제한적이며,  300개까지 데이터 정보를 가질 수 있다.

즉, 쿠키를 사용할수 있는 최대 용량은 4KB * 300개 = 1.2MB 이다.

 

예를들어,

어떤 웹 사이트를 처음 방문하여 로그인해서 사용하고 나면, 아이디와 패스워드를 기록한 쿠키가 만들어진다. 그 다음부터 접속할 때는 별도의 절차 없이 사이트에 접속한다. 쿠키는 이러한 목적을 위해 만들어졌다.



#### 쿠키의 단점

쿠키는 웹브라우저가 방문했던 웹사이트에 대한 정보, 개인의 정보가 기록되기 때문에 개인의 사생활이나 정보를 침해할 소지가 있다. 

이러한 보안상의 문제를 조금이나마 해소하기 위해 웹 브라우저 자체에 쿠키 거부 기능이 추가되었다. 

쿠키 거부 기능이 설정되어 있으면, 쿠키의 본래 목적인 웹 브라우저와의 연결을 지속시키는 기능을 수행할 수 없게 된다. 

이것이 쿠키의 치명적인 단점이다.



---



## 쿠키 관련 메소드

- setMaxAge()  : 쿠키의 유효기간을 설정
- setpath() : 쿠키의 유효 디렉토리 설정
- setValue() : 쿠키의 값을 설정
- setVersion() : 쿠키 버전을 설정
- getMaxAge() : 쿠키의 유효시간을 구한다.
- getPath() : 쿠키의 전송경로를 구한다.
- getName() : 쿠키의 이름을 구한다.
- getValue() : 쿠키의 값을 구한다.
- getVersion() : 쿠키 버전을 구한다.



---



## 쿠키 사용하기

### 쿠키의 정보를 클라이언트에 저장하는 법

##### 1. 쿠키 객체를 생성

("쿠키 이름", "쿠키 값")

```Java
Cookie cookie = new Cookie("cookieName","cookieValue");
```



##### 2. 쿠키 속성 설정

생성된 쿠키 객체의 유효기간을 설정한다.

쿠키의 유효시간은 **초** 단위로 지정된다.  (ex) 60초(1분) * 60 = 1시간

````java
cookie.setMaxAge(365*24*60*60);  // 1년간 유지됨
````

음수를 입력할 경우에는 웹 브라우저를 닫을 때 쿠키가 함께 삭제된다.

```java
cookie.setMaxAge(-1);
```

 

##### 3. 쿠키 전송

**response** 객체에 쿠키를 탑재한다.

cookie객체를 response 객체에 addCookie() 메소드를 이용해서 쿠키를 추가한다.

```jsp
response.addCookie(cookie);
```



### 서버가 클라이언트로부터 쿠키의 정보를 얻어오는 법

##### 1. 쿠키 객체 얻어오기

```Jsp
Cookie[] cookies = request.getCookies();
```

쿠키는 대부분 여러개가 있으므로 배열형태로 가져온다.

request 객체의 getCookies() 메소드를 이용해서 클라이언트의 설정된 모든 쿠키 객체들을 얻어올 수 있다.



##### 2. 쿠기 객체에 설정된 값 알아내기

쿠키의 이름을 알아내기 위해 **getName()** 사용

쿠키의 값을 알아내기 위해 **getValue()** 사용

```jsp
for(Cookie cookie : cookies) {
	out.println(cookie.getName() + " : "+ cookie.getValue() + "<br>");
}
```





### 쿠키 삭제하기

쿠키를 삭제하는 방법은 간단하다.

쿠키의 유효기간을 만료시키면 된다.

유효기간을 결정하는 메소드 setMaxAge() 에 유효기간을 0으로 설정하면 된다.

```jsp
cookie.setMaxAge(0);
```

